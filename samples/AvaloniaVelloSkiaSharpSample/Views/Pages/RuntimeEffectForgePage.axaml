<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:rendering="clr-namespace:AvaloniaVelloSkiaSharpSample.Rendering"
             x:Class="AvaloniaVelloSkiaSharpSample.Views.Pages.RuntimeEffectForgePage">
  <Grid Margin="24"
        RowDefinitions="Auto,*"
        ColumnDefinitions="360,*"
        RowSpacing="16"
        ColumnSpacing="16">
    <StackPanel Grid.ColumnSpan="2"
                Spacing="4">
      <TextBlock Text="Runtime Effect Forge"
                 FontSize="20"
                 FontWeight="SemiBold" />
      <TextBlock Text="Compile SkSL presets, tweak uniforms, and observe fallback diagnostics when the runtime effect backend is unavailable."
                 Opacity="0.78"
                 TextWrapping="Wrap" />
    </StackPanel>

    <ScrollViewer Grid.Row="1"
                  HorizontalScrollBarVisibility="Disabled">
      <StackPanel Spacing="16">
        <Border Background="#111722"
                CornerRadius="8"
                Padding="12">
          <StackPanel Spacing="12">
            <TextBlock Text="Preset"
                       FontWeight="SemiBold" />
            <ComboBox ItemsSource="{Binding Presets}"
                      SelectedItem="{Binding SelectedPreset}">
              <ComboBox.ItemTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding Name}" />
                </DataTemplate>
              </ComboBox.ItemTemplate>
            </ComboBox>

            <StackPanel Spacing="8">
              <TextBlock Text="Intensity"
                         FontWeight="SemiBold"
                         Opacity="0.72" />
              <StackPanel Orientation="Horizontal"
                          Spacing="8"
                          VerticalAlignment="Center">
                <Slider Width="220"
                        Minimum="0.1"
                        Maximum="2"
                        Value="{Binding Intensity}"
                        TickFrequency="0.1" />
                <TextBlock Text="{Binding Intensity, StringFormat='{}{0:F2}'}"
                           Width="60" />
              </StackPanel>
            </StackPanel>

            <StackPanel Spacing="8">
              <TextBlock Text="Time scale"
                         FontWeight="SemiBold"
                         Opacity="0.72" />
              <StackPanel Orientation="Horizontal"
                          Spacing="8"
                          VerticalAlignment="Center">
                <Slider Width="220"
                        Minimum="0"
                        Maximum="2.5"
                        Value="{Binding Speed}"
                        TickFrequency="0.1" />
                <TextBlock Text="{Binding Speed, StringFormat='{}{0:F2}'}"
                           Width="60" />
              </StackPanel>
            </StackPanel>

            <CheckBox Content="Animate"
                      IsChecked="{Binding Animate}" />

            <Button Content="Capture snapshot"
                    Command="{Binding CaptureSnapshotCommand}" />
            <TextBlock Text="{Binding CaptureStatus}"
                       FontSize="11"
                       Opacity="0.75"
                       TextWrapping="Wrap" />
          </StackPanel>
        </Border>

        <Border Background="#111722"
                CornerRadius="8"
                Padding="12">
          <StackPanel Spacing="8">
            <TextBlock Text="Shader Source"
                       FontWeight="SemiBold" />
            <TextBox Text="{Binding ShaderSource, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True"
                     AcceptsTab="True"
                     FontFamily="Consolas, Courier New"
                     MinHeight="220"
                     Watermark="Enter SkSL hereâ€¦"
                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                     ScrollViewer.VerticalScrollBarVisibility="Auto" />
            <StackPanel Orientation="Horizontal"
                        Spacing="8">
              <Button Content="Compile"
                      Command="{Binding CompileShaderCommand}"
                      IsEnabled="{Binding CanCompile}" />
              <Button Content="Reset preset"
                      Command="{Binding ResetShaderCommand}"
                      IsEnabled="{Binding HasShaderChanges}" />
            </StackPanel>
          </StackPanel>
        </Border>

        <Border Background="#111722"
                CornerRadius="8"
                Padding="12">
          <StackPanel Spacing="6">
            <TextBlock Text="Compilation Status"
                       FontWeight="SemiBold" />
            <TextBlock Text="{Binding CompilationStatus}"
                       FontFamily="Consolas, Courier New"
                       FontSize="12"
                       TextWrapping="Wrap" />
          </StackPanel>
        </Border>
      </StackPanel>
    </ScrollViewer>

    <Border Grid.Row="1"
            Grid.Column="1"
            Background="#101722"
            CornerRadius="12"
            Padding="16">
      <rendering:SkiaLeaseSurface Renderer="{Binding}"
                                   BackendDescriptor="{Binding BackendDescriptor}" />
    </Border>
  </Grid>
</UserControl>
