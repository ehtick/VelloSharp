<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <IsPackable>true</IsPackable>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <PackageId Condition="'$(PackageId)'==''">$(NativePackagePrefix)</PackageId>
    <Title Condition="'$(Title)'==''">$(PackageId)</Title>
    <Description Condition="'$(Description)'==''">Native $(NativeFriendlyName) bundle with all supported runtimes.</Description>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.android-arm64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/android-arm64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/android-arm64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.browser-wasm.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/browser-wasm/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/browser-wasm/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.ios-arm64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/ios-arm64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/ios-arm64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.iossimulator-x64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/iossimulator-x64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/iossimulator-x64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.linux-arm64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/linux-arm64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/linux-arm64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.linux-x64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/linux-x64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/linux-x64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.osx-arm64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/osx-arm64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/osx-arm64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.osx-x64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/osx-x64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/osx-x64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.win-arm64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/win-arm64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/win-arm64/native')" />
    <ProjectReference Include="VelloSharp.Native.TreeDataGrid.win-x64.csproj" Condition="Exists('$(RepositoryRoot)/artifacts/runtimes/win-x64/native') Or Exists('$(MSBuildThisFileDirectory)runtimes/win-x64/native')" />
  </ItemGroup>
  <ItemGroup Condition="Exists('$(MSBuildThisFileDirectory)runtimes')">
    <_MetaAsset Include="$(MSBuildThisFileDirectory)runtimes\**\$(NativeBinaryName).*"
                Condition="'$(NativeBinaryName)' != ''" />
    <_MetaAsset Include="$(MSBuildThisFileDirectory)runtimes\**\lib$(NativeBinaryName).*"
                Condition="'$(NativeBinaryName)' != ''" />
    <_MetaAsset Include="$(MSBuildThisFileDirectory)runtimes\**\*"
                Condition="'$(NativeBinaryName)' == ''" />
  </ItemGroup>
  <ItemGroup Condition="'@(_MetaAsset)' != ''">
    <Content Include="@(_MetaAsset)"
             Pack="true"
             PackagePath="runtimes/%(RecursiveDir)%(Filename)%(Extension)"
             Visible="false">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
      <TargetPath>runtimes\%(RecursiveDir)%(Filename)%(Extension)</TargetPath>
    </Content>
  </ItemGroup>
</Project>
